-- 복잡하게 생각해서 삽질을 많이 했던 문제

select w.id, wp.age, w.coins_needed, w.power
from wands w
join wands_property wp
on w.code=wp.code
where wp.is_evil=0
and w.coins_needed =
    (select min(w2.coins_needed)
        from wands w2
        join wands_property wp2
        on w2.code=wp2.code
        where w.power=w2.power
        and wp.age=wp2.age)
order by w.power desc, wp.age desc



-- try2: row_number() 활용해서 끊어보기
-- MySQL Version: 8.0.20 (https://www.hackerrank.com/environment)
-- 참고: https://dev.mysql.com/doc/refman/8.0/en/window-function-descriptions.html#function_row-number

--일단 번호부터 부여해보기(실패)
select w2.power, wp2.age, row_number() over wind as row_num
    from wands w2
    join wands_property wp2
    on w2.code = wp2.code
window wind as (order by w2.coins_needed)
